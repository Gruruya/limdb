<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LimDB</title>

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<!-- JS -->
<script type="text/javascript" src="dochack.js"></script>
</head>
<body>
  <div class="document" id="documentId">
    <div class="container">
      <h1 class="title">LimDB</h1>
      <div class="row">
  <div class="three columns">
    <div class="theme-select-wrapper">
      <label for="theme-select">Theme:&nbsp;</label>
      <select id="theme-select" onchange="setTheme(this.value)">
        <option value="auto">ðŸŒ— Match OS</option>
        <option value="dark">ðŸŒ‘ Dark</option>
        <option value="light">ðŸŒ• Light</option>
      </select>
    </div>
    <div id="global-links">
      <ul class="simple">
        <li><a id="indexLink" href="theindex.html">Index</a></li>
      </ul>
    </div>
    <div id="searchInputDiv">
      Search: <input type="search" id="searchInput" onkeyup="search()"/>
    </div>
    <div>
      Group by:
      <select onchange="groupBy(this.value)">
        <option value="section">Section</option>
        <option value="type">Type</option>
      </select>
    </div>
    <ul class="simple simple-toc" id="toc-list">
  <li><a class="reference" id="whyqmark_toc" href="#whyqmark">Why?</a></li>
<li><a class="reference" id="simple-usage_toc" href="#simple-usage">Simple Usage</a></li>
<li><a class="reference" id="grouped-read-and-write_toc" href="#grouped-read-and-write">Grouped read and write</a></li>
<li><a class="reference" id="named-databases_toc" href="#named-databases">Named Databases</a></li>
<ul class="simple"><li><a class="reference" id="named-databases-data-types_toc" href="#named-databases-data-types">Data Types</a></li>
</ul><li><a class="reference" id="iterators_toc" href="#iterators">Iterators</a></li>
<ul class="simple"><li><a class="reference" id="iterators-transactions_toc" href="#iterators-transactions">Transactions</a></li>
</ul><li><a class="reference" id="improvement-areas-of-interest_toc" href="#improvement-areas-of-interest">Improvement Areas Of Interest</a></li>
<li><a class="reference" id="migrating-from-0dot2_toc" href="#migrating-from-0dot2">Migrating from 0.2</a></li>
<li><a class="reference" id="why-is-it-called-limdbqmark_toc" href="#why-is-it-called-limdbqmark">Why is it called LimDB?</a></li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#7" id="57">Types</a></summary>
    <ul class="simple simple-toc-section">
      <li><a class="reference" href="#Blob" title="Blob = Val">Blob</a></li>
<li><a class="reference" href="#Concludes" title="Concludes = object">Concludes</a></li>
<li><a class="reference" href="#Database" title="Database[A; B] = object
  env*: LMDBEnv
  dbi*: Dbi">Database</a></li>
<li><a class="reference" href="#LimDefect" title="LimDefect = object of Defect">LimDefect</a></li>
<li><a class="reference" href="#Transaction" title="Transaction[A; B] = object
  txn*: LMDBTxn
  dbi*: Dbi">Transaction</a></li>
<li><a class="reference" href="#Writes" title="Writes = object">Writes</a></li>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#12" id="62">Procs</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">[]
  <li><a class="reference" href="#%5B%5D%2CDatabase%5BA%2CB%5D%2CA" title="`[]`[A, B](d: Database[A, B]; key: A): B">`[]`[A, B](d: Database[A, B]; key: A): B</a></li>
<li><a class="reference" href="#%5B%5D%2CTransaction%5BA%2CB%5D%2CA" title="`[]`[A, B](t: Transaction[A, B]; key: A): B">`[]`[A, B](t: Transaction[A, B]; key: A): B</a></li>

</ul>
<ul class="simple nested-toc-section">[]=
  <li><a class="reference" href="#%5B%5D%3D%2CDatabase%5BA%2CB%5D%2CA%2CB" title="`[]=`[A, B](d: Database[A, B]; key: A; val: B)">`[]=`[A, B](d: Database[A, B]; key: A; val: B)</a></li>
<li><a class="reference" href="#%5B%5D%3D%2CTransaction%5BA%2CB%5D%2CA%2CB" title="`[]=`[A, B](t: Transaction[A, B]; key: A; val: B)">`[]=`[A, B](t: Transaction[A, B]; key: A; val: B)</a></li>

</ul>
<ul class="simple nested-toc-section">clear
  <li><a class="reference" href="#clear%2CDatabase%5BA%2CB%5D" title="clear[A, B](d: Database[A, B])">clear[A, B](d: Database[A, B])</a></li>

</ul>
<ul class="simple nested-toc-section">commit
  <li><a class="reference" href="#commit%2CTransaction%5BA%2CB%5D" title="commit[A, B](t: Transaction[A, B])">commit[A, B](t: Transaction[A, B])</a></li>

</ul>
<ul class="simple nested-toc-section">contains
  <li><a class="reference" href="#contains%2CTransaction%5BA%2CB%5D%2CA" title="contains[A, B](t: Transaction[A, B]; key: A): bool">contains[A, B](t: Transaction[A, B]; key: A): bool</a></li>

</ul>
<ul class="simple nested-toc-section">copy
  <li><a class="reference" href="#copy%2CDatabase%5BA%2CB%5D%2Cstring" title="copy[A, B](d: Database[A, B]; filename: string)">copy[A, B](d: Database[A, B]; filename: string)</a></li>

</ul>
<ul class="simple nested-toc-section">del
  <li><a class="reference" href="#del%2CDatabase%5BA%2CB%5D%2CA" title="del[A, B](d: Database[A, B]; key: A)">del[A, B](d: Database[A, B]; key: A)</a></li>
<li><a class="reference" href="#del%2CDatabase%5BA%2CB%5D%2CA%2CB" title="del[A, B](d: Database[A, B]; key: A; val: B)">del[A, B](d: Database[A, B]; key: A; val: B)</a></li>
<li><a class="reference" href="#del%2CTransaction%5BA%2CB%5D%2CA%2CB" title="del[A, B](t: Transaction[A, B]; key: A; val: B)">del[A, B](t: Transaction[A, B]; key: A; val: B)</a></li>

</ul>
<ul class="simple nested-toc-section">fromBlob
  <li><a class="reference" href="#fromBlob%2CVal%2Ctypedesc%5B%5D" title="fromBlob(b: Blob; T: typedesc[SomeNumber | array | tuple | object]): T:type">fromBlob(b: Blob; T: typedesc[SomeNumber | array | tuple | object]): T:type</a></li>
<li><a class="reference" href="#fromBlob%2CVal%2Ctypedesc%5Bstring%5D" title="fromBlob(b: Blob; T: typedesc[string]): string">fromBlob(b: Blob; T: typedesc[string]): string</a></li>

</ul>
<ul class="simple nested-toc-section">getOrDefault
  <li><a class="reference" href="#getOrDefault%2CDatabase%5BA%2CB%5D%2CA" title="getOrDefault[A, B](d: Database[A, B]; key: A): B">getOrDefault[A, B](d: Database[A, B]; key: A): B</a></li>
<li><a class="reference" href="#getOrDefault%2CTransaction%5BA%2CB%5D%2CA" title="getOrDefault[A, B](t: Transaction[A, B]; key: A): B">getOrDefault[A, B](t: Transaction[A, B]; key: A): B</a></li>

</ul>
<ul class="simple nested-toc-section">getOrPut
  <li><a class="reference" href="#getOrPut%2CDatabase%5BA%2CB%5D%2CA%2CB" title="getOrPut[A, B](d: Database[A, B]; key: A; val: B): B">getOrPut[A, B](d: Database[A, B]; key: A; val: B): B</a></li>
<li><a class="reference" href="#getOrPut%2CTransaction%5BA%2CB%5D%2CA%2CB" title="getOrPut[A, B](t: Transaction[A, B]; key: A; val: B): B">getOrPut[A, B](t: Transaction[A, B]; key: A; val: B): B</a></li>

</ul>
<ul class="simple nested-toc-section">hasKey
  <li><a class="reference" href="#hasKey%2CDatabase%5BA%2CB%5D%2CA" title="hasKey[A, B](d: Database[A, B]; key: A): bool">hasKey[A, B](d: Database[A, B]; key: A): bool</a></li>
<li><a class="reference" href="#hasKey%2CTransaction%5BA%2CB%5D%2CA" title="hasKey[A, B](t: Transaction[A, B]; key: A): bool">hasKey[A, B](t: Transaction[A, B]; key: A): bool</a></li>

</ul>
<ul class="simple nested-toc-section">hasKeyOrPut
  <li><a class="reference" href="#hasKeyOrPut%2CDatabase%5BA%2CB%5D%2CA%2CB" title="hasKeyOrPut[A, B](d: Database[A, B]; key: A; val: B): bool">hasKeyOrPut[A, B](d: Database[A, B]; key: A; val: B): bool</a></li>
<li><a class="reference" href="#hasKeyOrPut%2CTransaction%5BA%2CB%5D%2CA%2CB" title="hasKeyOrPut[A, B](t: Transaction[A, B]; key: A; val: B): bool">hasKeyOrPut[A, B](t: Transaction[A, B]; key: A; val: B): bool</a></li>

</ul>
<ul class="simple nested-toc-section">initDatabase
  <li><a class="reference" href="#initDatabase%2CDatabase%2Cstring" title="initDatabase[A, B](d: Database; name = &quot;&quot;): Database[A, B]">initDatabase[A, B](d: Database; name = &quot;&quot;): Database[A, B]</a></li>
<li><a class="reference" href="#initDatabase%2Cstring%2Cstring%2Cint%2Cint" title="initDatabase[A, B](filename = &quot;&quot;; name = &quot;&quot;; maxdbs = 254; size = 10485760): Database[
    A, B]">initDatabase[A, B](filename = &quot;&quot;; name = &quot;&quot;; maxdbs = 254; size = 10485760): Database[
    A, B]</a></li>

</ul>
<ul class="simple nested-toc-section">initTransaction
  <li><a class="reference" href="#initTransaction%2CDatabase%5BA%2CB%5D" title="initTransaction[A, B](d: Database[A, B]): Transaction[A, B]">initTransaction[A, B](d: Database[A, B]): Transaction[A, B]</a></li>

</ul>
<ul class="simple nested-toc-section">len
  <li><a class="reference" href="#len%2CDatabase%5BA%2CB%5D" title="len[A, B](d: Database[A, B]): int">len[A, B](d: Database[A, B]): int</a></li>

</ul>
<ul class="simple nested-toc-section">open
  <li><a class="reference" href="#open%2CDatabase%5BA%2CB%5D%2Cstring" title="open[A, B](d: Database[A, B]; name: string): Dbi">open[A, B](d: Database[A, B]; name: string): Dbi</a></li>

</ul>
<ul class="simple nested-toc-section">pop
  <li><a class="reference" href="#pop%2CDatabase%5BA%2CB%5D%2CA%2CB" title="pop[A, B](d: Database[A, B]; key: A; val: var B): bool">pop[A, B](d: Database[A, B]; key: A; val: var B): bool</a></li>
<li><a class="reference" href="#pop%2CTransaction%5BA%2CB%5D%2CA%2CB" title="pop[A, B](t: Transaction[A, B]; key: A; val: var B): bool">pop[A, B](t: Transaction[A, B]; key: A; val: var B): bool</a></li>

</ul>
<ul class="simple nested-toc-section">reset
  <li><a class="reference" href="#reset%2CTransaction%5BA%2CB%5D" title="reset[A, B](t: Transaction[A, B])">reset[A, B](t: Transaction[A, B])</a></li>

</ul>
<ul class="simple nested-toc-section">take
  <li><a class="reference" href="#take%2CDatabase%5BA%2CB%5D%2CA%2CB" title="take[A, B](d: Database[A, B]; key: A; val: var B): bool">take[A, B](d: Database[A, B]; key: A; val: var B): bool</a></li>
<li><a class="reference" href="#take%2CTransaction%5BA%2CB%5D%2CA%2CB" title="take[A, B](t: Transaction[A, B]; key: A; val: var B): bool">take[A, B](t: Transaction[A, B]; key: A; val: var B): bool</a></li>

</ul>
<ul class="simple nested-toc-section">toBlob
  <li><a class="reference" href="#toBlob%2Cstring" title="toBlob(s: string): Blob">toBlob(s: string): Blob</a></li>

</ul>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#15" id="65">Iterators</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">keys
  <li><a class="reference" href="#keys.i%2CDatabase%5BA%2CB%5D" title="keys[A, B](d: Database[A, B]): A">keys[A, B](d: Database[A, B]): A</a></li>
<li><a class="reference" href="#keys.i%2CTransaction%5BA%2CB%5D" title="keys[A, B](t: Transaction[A, B]): A">keys[A, B](t: Transaction[A, B]): A</a></li>

</ul>
<ul class="simple nested-toc-section">mpairs
  <li><a class="reference" href="#mpairs.i%2CDatabase%5BA%2CB%5D" title="mpairs[A, B](d: Database[A, B]): (A, var B)">mpairs[A, B](d: Database[A, B]): (A, var B)</a></li>
<li><a class="reference" href="#mpairs.i%2CTransaction%5BA%2CB%5D" title="mpairs[A, B](t: Transaction[A, B]): (A, var B)">mpairs[A, B](t: Transaction[A, B]): (A, var B)</a></li>

</ul>
<ul class="simple nested-toc-section">mvalues
  <li><a class="reference" href="#mvalues.i%2CDatabase%5BA%2CB%5D" title="mvalues[A, B](d: Database[A, B]): var B">mvalues[A, B](d: Database[A, B]): var B</a></li>
<li><a class="reference" href="#mvalues.i%2CTransaction%5BA%2CB%5D" title="mvalues[A, B](t: Transaction[A, B]): var B">mvalues[A, B](t: Transaction[A, B]): var B</a></li>

</ul>
<ul class="simple nested-toc-section">pairs
  <li><a class="reference" href="#pairs.i%2CDatabase%5BA%2CB%5D" title="pairs[A, B](d: Database[A, B]): (A, B)">pairs[A, B](d: Database[A, B]): (A, B)</a></li>
<li><a class="reference" href="#pairs.i%2CTransaction%5BA%2CB%5D" title="pairs[A, B](t: Transaction[A, B]): (A, B)">pairs[A, B](t: Transaction[A, B]): (A, B)</a></li>

</ul>
<ul class="simple nested-toc-section">values
  <li><a class="reference" href="#values.i%2CDatabase%5BA%2CB%5D" title="values[A, B](d: Database[A, B]): B">values[A, B](d: Database[A, B]): B</a></li>
<li><a class="reference" href="#values.i%2CTransaction%5BA%2CB%5D" title="values[A, B](t: Transaction[A, B]): B">values[A, B](t: Transaction[A, B]): B</a></li>

</ul>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#18" id="68">Templates</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">clear
  <li><a class="reference" href="#clear.t%2CTransaction%5BA%2CB%5D" title="clear[A, B](t: Transaction[A, B])">clear[A, B](t: Transaction[A, B])</a></li>

</ul>
<ul class="simple nested-toc-section">close
  <li><a class="reference" href="#close.t%2CDatabase%5BA%2CB%5D" title="close[A, B](d: Database[A, B])">close[A, B](d: Database[A, B])</a></li>

</ul>
<ul class="simple nested-toc-section">contains
  <li><a class="reference" href="#contains.t%2CDatabase%5BA%2CB%5D%2CA" title="contains[A, B](d: Database[A, B]; key: A): bool">contains[A, B](d: Database[A, B]; key: A): bool</a></li>

</ul>
<ul class="simple nested-toc-section">del
  <li><a class="reference" href="#del.t%2CTransaction%5BA%2CB%5D%2CA" title="del[A, B](t: Transaction[A, B]; key: A)">del[A, B](t: Transaction[A, B]; key: A)</a></li>

</ul>
<ul class="simple nested-toc-section">len
  <li><a class="reference" href="#len.t%2CTransaction%5BA%2CB%5D" title="len[A, B](t: Transaction[A, B]): int">len[A, B](t: Transaction[A, B]): int</a></li>

</ul>
<ul class="simple nested-toc-section">toBlob
  <li><a class="reference" href="#toBlob.t" title="toBlob(x: SomeNumber | array | tuple | object): Blob">toBlob(x: SomeNumber | array | tuple | object): Blob</a></li>

</ul>
<ul class="simple nested-toc-section">with
  <li><a class="reference" href="#with.t%2CDatabase%2Cuntyped" title="with(db: Database; body: untyped)">with(db: Database; body: untyped)</a></li>

</ul>

    </ul>
  </details>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
    
    <div id="tocRoot"></div>
    
    <p class="module-desc"><p>Fast, in-process key-value store with a table-like interface persisted to disk using lmdb.</p>

<h1><a class="toc-backref" id="whyqmark" href="#whyqmark">Why?</a></h1><p>Memory-mapped files are one of the fastest ways to store data but are not safe to access concurrently. Lmdb is a proven and mature to solution to that problem, offering full compliance to ACID3, a common standard for database reliability, while keeping most of the speed.</p>
<p>Leveraging the excellent nim-lmdb interface, LimDB makes a larg-ish sub-set of lmdb features available in an interface familiar to Nim users who have experience with a table.</p>
<p>While programming with LimDB feels like using a table, it is still very much lmdb. Some common boilerplate is automated and LimDB is clever about bundling lmdb's moving parts, but there are no bolted-on bits or obscuring of lmdb's behavior.</p>

<h1><a class="toc-backref" id="simple-usage" href="#simple-usage">Simple Usage</a></h1><p>Provide LimDB with a local storage directory and then use it like you would use a table. After inserting the element, it's on disk an can be accessed even after the program is restarted, or concurrently by different threads or processes.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Identifier">string</span><span class="Punctuation">,</span> <span class="Identifier">string</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Identifier">db</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;bar&quot;</span>  <span class="Comment"># that's it, foo -&gt; bar is now on disk</span>
<span class="Identifier">echo</span> <span class="Identifier">db</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span>     <span class="Comment"># prints bar</span></pre><p>Now if you comment out the write, you can run the program again and read the value off disk</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Identifier">string</span><span class="Punctuation">,</span> <span class="Identifier">string</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Comment"># db[&quot;foo&quot;] = &quot;bar&quot;</span>
<span class="Identifier">echo</span> <span class="Identifier">db</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span>  <span class="Comment"># also prints &quot;bar&quot;</span></pre><p>That's it. If you just need to quickly save some data, you can stop reading here and start programming.</p>

<h1><a class="toc-backref" id="grouped-read-and-write" href="#grouped-read-and-write">Grouped read and write</a></h1><p>If you have several programs or several parts of your program reading and writing on tables backed by the same directory, it's good to have a way of making sure all your reading and writing is referring to the table at the same time. This way, you know that the value you wrote has not been overwritten from elsewhere while your program was running. Even if you don't plan on running several parts of your program, it's great for peace of mind.</p>
<p>Use a <tt class="docutils literal"><span class="pre"><span class="Identifier">with</span></span></tt> block to group your reads and writes in this way. The block contains a special variable <tt class="docutils literal"><span class="pre"><span class="Identifier">t</span></span></tt> that can be used just like a database object.</p>
<p>All reads and writes are guaranteed to be consistent with each other, and if there is an error, all writes will be reverted.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Identifier">string</span><span class="Punctuation">,</span> <span class="Identifier">string</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Identifier">with</span> <span class="Identifier">db</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span>
  <span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;buz&quot;</span></pre>
<h1><a class="toc-backref" id="named-databases" href="#named-databases">Named Databases</a></h1><p>More than one database can be placed in the same storage location. No keys or values are shared between databases, so the key foo will remain empty in database B if it is set in database A.</p>
<p>To access more than one database in the same Nim program, create an additional database from an existing one. The connection and storage location will be shared.</p>
<p>The default database, the one used in the examples above, also has a name, an empty string <tt class="docutils literal"><span class="pre"><span class="StringLit">&quot;&quot;</span></span></tt>.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Identifier">string</span><span class="Punctuation">,</span> <span class="Identifier">string</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>

<span class="Keyword">let</span> <span class="Identifier">db2</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Punctuation">:</span><span class="Identifier">string</span><span class="Punctuation">,</span> <span class="Identifier">string</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;myName&quot;</span><span class="Punctuation">)</span>

<span class="Identifier">db</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;bar&quot;</span>
<span class="Identifier">db2</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;another bar</span></pre><p>Database objects created from other database objects do not differ from ones created directly from a filename.</p>
<p>Only one database may be initialized from the same storage location, additional ones can be created from it.</p>
<div class="admonition admonition-warning"><span class="admonition-warning-text"><b>Caution:</b></span>
If you use named databases, their names will appear as keys in the default database, The one named empty string <tt class="docutils literal"><span class="pre"><span class="StringLit">&quot;&quot;</span></span></tt>. In this case it is usually best not to use the default database for anything else, and iterate over the default databases' keys to get a list of named databases.</div>

<h2><a class="toc-backref" id="named-databases-data-types" href="#named-databases-data-types">Data Types</a></h2><p>So far, we have only been using strings for keys and values. But you can use any system data type you like except references.</p>
<p>You can create several databases in the same directory with different data types.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Identifier">int</span><span class="Punctuation">,</span> <span class="Identifier">float</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;aDatabaseWithNumbers&quot;</span><span class="Punctuation">)</span>

<span class="Identifier">db</span><span class="Punctuation">[</span><span class="DecNumber">3</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="FloatNumber">3.3</span>

<span class="Keyword">type</span>
  <span class="Identifier">Foo</span> <span class="Operator">=</span> <span class="Keyword">object</span>
    <span class="Identifier">a</span><span class="Punctuation">:</span> <span class="Identifier">int</span>
    <span class="Identifier">b</span><span class="Punctuation">:</span> <span class="Identifier">float</span>

<span class="Keyword">let</span> <span class="Identifier">db2</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Punctuation">:</span> <span class="Identifier">array</span><span class="Punctuation">[</span><span class="DecNumber">2</span><span class="Punctuation">,</span> <span class="Identifier">int</span><span class="Punctuation">]</span><span class="Punctuation">,</span> <span class="Identifier">Foo</span> <span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;aDatabaseWithArraysAndObjects&quot;</span><span class="Punctuation">)</span>
<span class="Identifier">with</span> <span class="Identifier">db</span><span class="Punctuation">:</span>
  <span class="Identifier">t</span><span class="Punctuation">[</span> <span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">2</span><span class="Punctuation">]</span> <span class="Punctuation">]</span> <span class="Operator">=</span> <span class="Identifier">Foo</span><span class="Punctuation">(</span><span class="Identifier">a</span><span class="Punctuation">:</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="Identifier">b</span><span class="Punctuation">:</span> <span class="FloatNumber">2.2</span><span class="Punctuation">)</span>
  <span class="Identifier">t</span><span class="Punctuation">[</span> <span class="Punctuation">[</span><span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="DecNumber">4</span><span class="Punctuation">]</span> <span class="Punctuation">]</span> <span class="Operator">=</span> <span class="Identifier">Foo</span><span class="Punctuation">(</span><span class="Identifier">a</span><span class="Punctuation">:</span> <span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="Identifier">b</span><span class="Punctuation">:</span> <span class="FloatNumber">4.4</span><span class="Punctuation">)</span>


<span class="Keyword">let</span> <span class="Identifier">db3</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Punctuation">:</span> <span class="Punctuation">(</span><span class="Identifier">int</span><span class="Punctuation">,</span> <span class="Identifier">int</span><span class="Punctuation">)</span><span class="Punctuation">,</span> <span class="Keyword">tuple</span><span class="Punctuation">[</span><span class="Identifier">a</span><span class="Punctuation">:</span> <span class="Identifier">int</span><span class="Punctuation">,</span> <span class="Identifier">b</span><span class="Punctuation">:</span> <span class="Identifier">float</span><span class="Punctuation">]</span> <span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;aDatabaseWithTuples&quot;</span><span class="Punctuation">)</span>

<span class="Identifier">db3</span><span class="Punctuation">[</span> <span class="Punctuation">(</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">2</span><span class="Punctuation">)</span> <span class="Punctuation">]</span> <span class="Operator">=</span> <span class="Punctuation">(</span><span class="Identifier">a</span><span class="Punctuation">:</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="Identifier">b</span><span class="Punctuation">:</span> <span class="FloatNumber">2.2</span><span class="Punctuation">)</span>
<span class="Identifier">db3</span><span class="Punctuation">[</span> <span class="Punctuation">(</span><span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="DecNumber">4</span><span class="Punctuation">)</span> <span class="Punctuation">]</span> <span class="Operator">=</span> <span class="Punctuation">(</span><span class="Identifier">a</span><span class="Punctuation">:</span> <span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="Identifier">b</span><span class="Punctuation">:</span> <span class="FloatNumber">4.4</span><span class="Punctuation">)</span></pre><div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
All supported data types are binary-copied in and out of the database, so their performance characteristics are the same. As usual with Nim, seq and string are copied once.</div>
<div class="admonition admonition-warning"><span class="admonition-warning-text"><b>Caution:</b></span>
It is recommended to hard-code the data types and the database name to make sure each database is only used with the data types that were already written to it. Opening a database with the wrong types can lead to unpredictable behavior, and writing to a database with the wrong types can lead to data loss.</div>

<h1><a class="toc-backref" id="iterators" href="#iterators">Iterators</a></h1><p>While you can access any data using the keys, you might want all of the data or not know the keys. You can use the usual <tt class="docutils literal"><span class="pre"><span class="Identifier">keys</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">values</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">pairs</span></span></tt> iterators with a LimDB. They can be used standalone on a database or as part of a transaciton.</p>
<p>You can also use <tt class="docutils literal"><span class="pre"><span class="Identifier">mvalues</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">mpairs</span></span></tt> to modify values on the go.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">[</span><span class="Identifier">string</span><span class="Punctuation">,</span> <span class="Identifier">string</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;bar&quot;</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;buz&quot;</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">commit</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Keyword">for</span> <span class="Identifier">key</span> <span class="Keyword">in</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">keys</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="Identifier">key</span>
<span class="Comment"># prints:</span>
<span class="Comment"># foo</span>
<span class="Comment"># fuz</span>

<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Keyword">for</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">values</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="Identifier">value</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">reset</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Comment"># prints:</span>
<span class="Comment"># bar</span>
<span class="Comment"># buz</span>

<span class="Keyword">for</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">db</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;$# -&gt; $#&quot;</span> <span class="Operator">%</span> <span class="Punctuation">(</span><span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span><span class="Punctuation">)</span>

<span class="Comment"># prints:</span>
<span class="Comment"># foo -&gt; bar</span>
<span class="Comment"># fuz -&gt; buz</span>

<span class="Keyword">for</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">mvalues</span><span class="Punctuation">:</span>
  <span class="Keyword">if</span> <span class="Identifier">value</span> <span class="Operator">==</span> <span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">:</span>
    <span class="Identifier">value</span> <span class="Operator">=</span> <span class="StringLit">&quot;buzz&quot;</span>

<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Keyword">for</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">mpairs</span><span class="Punctuation">:</span>
  <span class="Keyword">if</span> <span class="Identifier">key</span> <span class="Operator">==</span> <span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">:</span>
    <span class="Identifier">value</span> <span class="Operator">=</span> <span class="StringLit">&quot;barz&quot;</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">commit</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Keyword">for</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">db</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;$# -&gt; $#&quot;</span> <span class="Operator">%</span> <span class="Punctuation">(</span><span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span><span class="Punctuation">)</span>

<span class="Comment"># prints:</span>
<span class="Comment"># foo -&gt; barz</span>
<span class="Comment"># fuz -&gt; buzz</span></pre>
<h2><a class="toc-backref" id="iterators-transactions" href="#iterators-transactions">Transactions</a></h2><p>Grouped reads and writes use a process called database transactions under the hood. They are quite common and most databases support them. At the beginning of a grouped read and write, a transaction <tt class="docutils literal"><span class="pre"><span class="Identifier">t</span></span></tt> is created. At the end of the block, it is reset if there are only read operations like <tt class="docutils literal"><span class="pre"><span class="Punctuation">[</span><span class="Punctuation">]</span></span></tt> in the block. If there is at least one write such as <tt class="docutils literal"><span class="pre"><span class="Punctuation">[</span><span class="Punctuation">]</span><span class="Operator">=</span></span></tt> or <tt class="docutils literal"><span class="pre"><span class="Identifier">del</span></span></tt>, it is committed.</p>
<p>If you would like to have more control, at the expense of having to be more careful, a transaction is started manually using <tt class="docutils literal"><span class="pre"><span class="Identifier">initTransaction</span></span></tt>, and stopped with either <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> or <tt class="docutils literal"><span class="pre"><span class="Identifier">commit</span></span></tt>. Use <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> if you only read data, or you want to throw away all writes. Use <tt class="docutils literal"><span class="pre"><span class="Identifier">commit</span></span></tt> to actually perform all the writes.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;bar&quot;</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;buz&quot;</span><span class="Identifier">se</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">commit</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;another bar&quot;</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;another buz&quot;</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">reset</span><span class="Punctuation">(</span><span class="Punctuation">)</span>  <span class="Comment"># foo and bar remain unchanged</span>

<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Identifier">echo</span> <span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span>
<span class="Identifier">echo</span> <span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;bar&quot;</span><span class="Punctuation">]</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">reset</span><span class="Punctuation">(</span><span class="Punctuation">)</span>  <span class="Comment"># read-only transactions are always reset</span></pre><div class="admonition admonition-warning"><span class="admonition-warning-text"><b>Caution:</b></span>
Make sure to reset transactions when exceptions are thrown. If you use a database object directly without calling <tt class="docutils literal"><span class="pre"><span class="Identifier">initTransaction</span></span></tt>, LimDB handles this for you.</div>

<h1><a class="toc-backref" id="improvement-areas-of-interest" href="#improvement-areas-of-interest">Improvement Areas Of Interest</a></h1><ul class="simple"><li>Use Nim views to provide an alternative interface allowing safe zero-copy data access in with Nim data types (lmdb itself does not copy data when accessing)</li>
<li>Useful iterators: <tt class="docutils literal"><span class="pre"><span class="Identifier">keysFrom</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">keysBetween</span></span></tt>, other common usage of lmdb cursors</li>
<li>Map lmdb multipe values per key feature to something Nimish, perhaps iterators or seqs</li>
</ul>

<h1><a class="toc-backref" id="migrating-from-0dot2" href="#migrating-from-0dot2">Migrating from 0.2</a></h1><p>This version 0.3 breaks backwards compatibility with 0.2 in order to support the normal Nim generic syntax.</p>
<p>You can <tt class="docutils literal"><span class="pre"><span class="Identifier">requires</span> <span class="Identifier">limdb</span><span class="Operator">=</span><span class="FloatNumber">0.2</span></span></tt> in your myProject.nimble file to keep the functionality you are used to, or make the following replacements to your code to upgrade:</p>
<p>Replace</p>
<pre>initDatabase(&quot;myDir&quot;)</pre>
<p>with</p>
<pre>initDatabase[string, string](&quot;path&quot;)</pre>
<p>And</p>
<pre>db.initDatabase(&quot;dbname&quot;)</pre>
<p>with</p>
<pre>db.initDatabase[:string, string](&quot;dbname&quot;)</pre>
<p>If you would like to stay at 0.2, the <a class="reference external" href="0.2/limdb.html">0.2 documentation</a> is still available.</p>

<h1><a class="toc-backref" id="why-is-it-called-limdbqmark" href="#why-is-it-called-limdbqmark">Why is it called LimDB?</a></h1><p>LimDB was originally named LimrodDB after the ancient king Nimrod's younger sibling, Limrod, who didn't make it into the history books because he was short. It was later renamed LimDB for marketing reasons.</p>
<p>By a wild coincidence, it also sounds a little like a vaguely pleasing jumble of Nim and LMDB.</p>
</p>
    <div class="section" id="7">
  <h1><a class="toc-backref" href="#7">Types</a></h1>
  <dl class="item">
    <div id="Blob">
  <dt><pre><a href="limdb.html#Blob"><span class="Identifier">Blob</span></a> <span class="Other">=</span> <span class="Identifier">Val</span></pre></dt>
  <dd>
    
    A variable-length collection of bytes that can be used as either a key or value. This is LMDB's native storage type- a block of memory. <tt class="docutils literal"><span class="pre"><span class="Identifier">string</span></span></tt> types are converted automatically, and conversion for other data types can be added by adding <tt class="docutils literal"><span class="pre"><span class="Identifier">fromBlob</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">toBlob</span></span></tt> for a type.
    
  </dd>
</div>
<div id="Concludes">
  <dt><pre><a href="limdb.html#Concludes"><span class="Identifier">Concludes</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  </pre></dt>
  <dd>
    
    A tag to track commits and rollbacks
    
  </dd>
</div>
<div id="Database">
  <dt><pre><a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">B</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">env</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">LMDBEnv</span>
  <span class="Identifier">dbi</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">Dbi</span>
</pre></dt>
  <dd>
    
    A key-value database in a memory-mapped on-disk storage location.
    
  </dd>
</div>
<div id="LimDefect">
  <dt><pre><a href="limdb.html#LimDefect"><span class="Identifier">LimDefect</span></a> <span class="Other">=</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">Defect</span></pre></dt>
  <dd>
    
    
    
  </dd>
</div>
<div id="Transaction">
  <dt><pre><a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">B</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">txn</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">LMDBTxn</span>
  <span class="Identifier">dbi</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">Dbi</span>
</pre></dt>
  <dd>
    
    A transaction may be created and reads or writes performed on it instead of directly on a database object. That way, reads or writes are not affected by other writes happening at the same time, and changes happen all at once at the end or not at all.
    
  </dd>
</div>
<div id="Writes">
  <dt><pre><a href="limdb.html#Writes"><span class="Identifier">Writes</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  </pre></dt>
  <dd>
    
    A tag to track write transactions
    
  </dd>
</div>

  </dl>
</div>
<div class="section" id="12">
  <h1><a class="toc-backref" href="#12">Procs</a></h1>
  <dl class="item">
    <div id="[]-procs-all">
  <div id="[],Database[A,B],A">
  <dt><pre><span class="Keyword">proc</span> <a href="#%5B%5D%2CDatabase%5BA%2CB%5D%2CA"><span class="Identifier">`[]`</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    Fetch a value in the database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>

    
  </dd>
</div>
<div id="[],Transaction[A,B],A">
  <dt><pre><span class="Keyword">proc</span> <a href="#%5B%5D%2CTransaction%5BA%2CB%5D%2CA"><span class="Identifier">`[]`</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="[]=-procs-all">
  <div id="[]=,Database[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#%5B%5D%3D%2CDatabase%5BA%2CB%5D%2CA%2CB"><span class="Identifier">`[]=`</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">B</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Set a value in the database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and commits a transaction under the hood</div>

    
  </dd>
</div>
<div id="[]=,Transaction[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#%5B%5D%3D%2CTransaction%5BA%2CB%5D%2CA%2CB"><span class="Identifier">`[]=`</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">B</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="limdb.html#Writes"><span class="Identifier">Writes</span></a><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="clear-procs-all">
  <div id="clear,Database[A,B]">
  <dt><pre><span class="Keyword">proc</span> <a href="#clear%2CDatabase%5BA%2CB%5D"><span class="Identifier">clear</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Remove all key-values pairs from the database, emptying it.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This creates and commits a transaction under the hood</div>

    
  </dd>
</div>

</div>
<div id="commit-procs-all">
  <div id="commit,Transaction[A,B]">
  <dt><pre><span class="Keyword">proc</span> <a href="#commit%2CTransaction%5BA%2CB%5D"><span class="Identifier">commit</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="limdb.html#Concludes"><span class="Identifier">Concludes</span></a><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Commit a transaction. This writes all changes made in the transaction to disk.
    
  </dd>
</div>

</div>
<div id="contains-procs-all">
  <div id="contains,Transaction[A,B],A">
  <dt><pre><span class="Keyword">proc</span> <a href="#contains%2CTransaction%5BA%2CB%5D%2CA"><span class="Identifier">contains</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Alias for hasKey to support <tt class="docutils literal"><span class="pre"><span class="Keyword">in</span></span></tt> syntax
    
  </dd>
</div>

</div>
<div id="copy-procs-all">
  <div id="copy,Database[A,B],string">
  <dt><pre><span class="Keyword">proc</span> <a href="#copy%2CDatabase%5BA%2CB%5D%2Cstring"><span class="Identifier">copy</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Copy a database to a different directory. This also performs routine database maintenance so the resulting file with usually be smaller. This is best performed when no one is writing to the database directory.
    
  </dd>
</div>

</div>
<div id="del-procs-all">
  <div id="del,Database[A,B],A">
  <dt><pre><span class="Keyword">proc</span> <a href="#del%2CDatabase%5BA%2CB%5D%2CA"><span class="Identifier">del</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Deletes a value in the database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and commits a transaction under the hood</div>
<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
LMDB requires you to delete by key and value. This proc fetches the value for you, giving you the more familiar interface.</div>

    
  </dd>
</div>
<div id="del,Database[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#del%2CDatabase%5BA%2CB%5D%2CA%2CB"><span class="Identifier">del</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">B</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Delete a key-value pair in the database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and commits a transaction under the hood</div>

    
  </dd>
</div>
<div id="del,Transaction[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#del%2CTransaction%5BA%2CB%5D%2CA%2CB"><span class="Identifier">del</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">B</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="limdb.html#Writes"><span class="Identifier">Writes</span></a><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Delete a key-value pair
    
  </dd>
</div>

</div>
<div id="fromBlob-procs-all">
  <div id="fromBlob,Val,typedesc[]">
  <dt><pre><span class="Keyword">proc</span> <a href="#fromBlob%2CVal%2Ctypedesc%5B%5D"><span class="Identifier">fromBlob</span></a><span class="Other">(</span><span class="Identifier">b</span><span class="Other">:</span> <a href="limdb.html#Blob"><span class="Identifier">Blob</span></a><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">typedesc</span><span class="Other">[</span><span class="Identifier">SomeNumber</span> <span class="Operator">|</span> <span class="Identifier">array</span> <span class="Operator">|</span> <span class="Keyword">tuple</span> <span class="Operator">|</span> <span class="Keyword">object</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">T:type</span></pre></dt>
  <dd>
    
    Convert a chunk of data, key or value, to a string<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
If you want other data types than a string, implement this for the data type</div>

    
  </dd>
</div>
<div id="fromBlob,Val,typedesc[string]">
  <dt><pre><span class="Keyword">proc</span> <a href="#fromBlob%2CVal%2Ctypedesc%5Bstring%5D"><span class="Identifier">fromBlob</span></a><span class="Other">(</span><span class="Identifier">b</span><span class="Other">:</span> <a href="limdb.html#Blob"><span class="Identifier">Blob</span></a><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">typedesc</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span></pre></dt>
  <dd>
    
    Convert a chunk of data, key or value, to a string<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
If you want other data types than a string, implement this for the data type</div>

    
  </dd>
</div>

</div>
<div id="getOrDefault-procs-all">
  <div id="getOrDefault,Database[A,B],A">
  <dt><pre><span class="Keyword">proc</span> <a href="#getOrDefault%2CDatabase%5BA%2CB%5D%2CA"><span class="Identifier">getOrDefault</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    Fetch a value in the database and return the provided default value if it does not exist
    
  </dd>
</div>
<div id="getOrDefault,Transaction[A,B],A">
  <dt><pre><span class="Keyword">proc</span> <a href="#getOrDefault%2CTransaction%5BA%2CB%5D%2CA"><span class="Identifier">getOrDefault</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    Read a value from a key in a transaction and return the provided default value if it does not exist
    
  </dd>
</div>

</div>
<div id="getOrPut-procs-all">
  <div id="getOrPut,Database[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#getOrPut%2CDatabase%5BA%2CB%5D%2CA%2CB"><span class="Identifier">getOrPut</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">B</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    Retrieves value of key as mutable copy or enters and returns val if not present
    
  </dd>
</div>
<div id="getOrPut,Transaction[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#getOrPut%2CTransaction%5BA%2CB%5D%2CA%2CB"><span class="Identifier">getOrPut</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">B</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    Retrieves value at key or enters and returns val if not present
    
  </dd>
</div>

</div>
<div id="hasKey-procs-all">
  <div id="hasKey,Database[A,B],A">
  <dt><pre><span class="Keyword">proc</span> <a href="#hasKey%2CDatabase%5BA%2CB%5D%2CA"><span class="Identifier">hasKey</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    See if a key exists without fetching any data in a transaction
    
  </dd>
</div>
<div id="hasKey,Transaction[A,B],A">
  <dt><pre><span class="Keyword">proc</span> <a href="#hasKey%2CTransaction%5BA%2CB%5D%2CA"><span class="Identifier">hasKey</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    See if a key exists without fetching any data
    
  </dd>
</div>

</div>
<div id="hasKeyOrPut-procs-all">
  <div id="hasKeyOrPut,Database[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#hasKeyOrPut%2CDatabase%5BA%2CB%5D%2CA%2CB"><span class="Identifier">hasKeyOrPut</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">B</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Returns true if <tt class="docutils literal"><span class="pre"><span class="Identifier">key</span></span></tt> is in the Database, otherwise inserts <tt class="docutils literal"><span class="pre"><span class="Identifier">value</span></span></tt>.
    
  </dd>
</div>
<div id="hasKeyOrPut,Transaction[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#hasKeyOrPut%2CTransaction%5BA%2CB%5D%2CA%2CB"><span class="Identifier">hasKeyOrPut</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Identifier">B</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Returns true if <tt class="docutils literal"><span class="pre"><span class="Identifier">key</span></span></tt> is in the transaction view of the database, otherwise inserts <tt class="docutils literal"><span class="pre"><span class="Identifier">value</span></span></tt>.
    
  </dd>
</div>

</div>
<div id="initDatabase-procs-all">
  <div id="initDatabase,Database,string">
  <dt><pre><span class="Keyword">proc</span> <a href="#initDatabase%2CDatabase%2Cstring"><span class="Identifier">initDatabase</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">name</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Database</span><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span></pre></dt>
  <dd>
    
    Open another database of a different name in an already-connected on-disk storage location.
    
  </dd>
</div>
<div id="initDatabase,string,string,int,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#initDatabase%2Cstring%2Cstring%2Cint%2Cint"><span class="Identifier">initDatabase</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">filename</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">;</span> <span class="Identifier">name</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">;</span> <span class="Identifier">maxdbs</span> <span class="Other">=</span> <span class="DecNumber">254</span><span class="Other">;</span> <span class="Identifier">size</span> <span class="Other">=</span> <span class="DecNumber">10485760</span><span class="Other">)</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span>
    <span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span></pre></dt>
  <dd>
    
    Connect to an on-disk storage location and open a database. If the path does not exist, a directory will be created.
    
  </dd>
</div>

</div>
<div id="initTransaction-procs-all">
  <div id="initTransaction,Database[A,B]">
  <dt><pre><span class="Keyword">proc</span> <a href="#initTransaction%2CDatabase%5BA%2CB%5D"><span class="Identifier">initTransaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span></pre></dt>
  <dd>
    
    <p>Start a transaction from a database.</p>
<p>Reads and writes on the transaction will reflect the same point in time and will not be affected by other writes.</p>
<p>After reads, <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> must be called on the transaction. After writes, <tt class="docutils literal"><span class="pre"><span class="Identifier">commit</span></span></tt> must be called to perform all of the writes, or <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> to perform none of them.</p>
<div class="admonition admonition-warning"><span class="admonition-warning-text"><b>Caution:</b></span>
Calling neither <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> nor <tt class="docutils literal"><span class="pre"><span class="Identifier">commit</span></span></tt> on a transaction can block database access. This commonly happens when an exception is raised.</div>

    
  </dd>
</div>

</div>
<div id="len-procs-all">
  <div id="len,Database[A,B]">
  <dt><pre><span class="Keyword">proc</span> <a href="#len%2CDatabase%5BA%2CB%5D"><span class="Identifier">len</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    Returns the number of key-value pairs in the database.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>

    
  </dd>
</div>

</div>
<div id="open-procs-all">
  <div id="open,Database[A,B],string">
  <dt><pre><span class="Keyword">proc</span> <a href="#open%2CDatabase%5BA%2CB%5D%2Cstring"><span class="Identifier">open</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Dbi</span></pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="pop-procs-all">
  <div id="pop,Database[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#pop%2CDatabase%5BA%2CB%5D%2CA%2CB"><span class="Identifier">pop</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">B</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Delete value in database. If it existed, return true and place value into <tt class="docutils literal"><span class="pre"><span class="Identifier">val</span></span></tt>
    
  </dd>
</div>
<div id="pop,Transaction[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#pop%2CTransaction%5BA%2CB%5D%2CA%2CB"><span class="Identifier">pop</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">B</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Delete value in database within transaction. If it existed, return true and place into <tt class="docutils literal"><span class="pre"><span class="Identifier">val</span></span></tt>
    
  </dd>
</div>

</div>
<div id="reset-procs-all">
  <div id="reset,Transaction[A,B]">
  <dt><pre><span class="Keyword">proc</span> <a href="#reset%2CTransaction%5BA%2CB%5D"><span class="Identifier">reset</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="limdb.html#Concludes"><span class="Identifier">Concludes</span></a><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Reset a transaction. This throws away all changes made in the transaction. After only reading in a transaction, reset it as well.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This is called <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> because that is a pleasant and familiar term for reverting changes. The term differs from LMDB though, under the hood this calles <tt class="docutils literal"><span class="pre"><span class="Identifier">mdb_abort</span></span></tt>, not <tt class="docutils literal"><span class="pre"><span class="Identifier">mdb_reset</span></span></tt>- the latter does something else not covered by LimDB.</div>

    
  </dd>
</div>

</div>
<div id="take-procs-all">
  <div id="take,Database[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#take%2CDatabase%5BA%2CB%5D%2CA%2CB"><span class="Identifier">take</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">B</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Alias for pop
    
  </dd>
</div>
<div id="take,Transaction[A,B],A,B">
  <dt><pre><span class="Keyword">proc</span> <a href="#take%2CTransaction%5BA%2CB%5D%2CA%2CB"><span class="Identifier">take</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">;</span> <span class="Identifier">val</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">B</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Alias for pop
    
  </dd>
</div>

</div>
<div id="toBlob-procs-all">
  <div id="toBlob,string">
  <dt><pre><span class="Keyword">proc</span> <a href="#toBlob%2Cstring"><span class="Identifier">toBlob</span></a><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <a href="limdb.html#Blob"><span class="Identifier">Blob</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Convert a string to a chunk of data, key or value, for LMDB<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
If you want other data types than a string, implement this for the data type</div>

    
  </dd>
</div>

</div>

  </dl>
</div>
<div class="section" id="15">
  <h1><a class="toc-backref" href="#15">Iterators</a></h1>
  <dl class="item">
    <div id="keys-iterators-all">
  <div id="keys.i,Database[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#keys.i%2CDatabase%5BA%2CB%5D"><span class="Identifier">keys</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">A</span></pre></dt>
  <dd>
    
    Iterate over all keys in a database.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>

    
  </dd>
</div>
<div id="keys.i,Transaction[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#keys.i%2CTransaction%5BA%2CB%5D"><span class="Identifier">keys</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">A</span></pre></dt>
  <dd>
    
    Iterate over all keys in a database with a transaction
    
  </dd>
</div>

</div>
<div id="mpairs-iterators-all">
  <div id="mpairs.i,Database[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#mpairs.i%2CDatabase%5BA%2CB%5D"><span class="Identifier">mpairs</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Keyword">var</span> <span class="Identifier">B</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Iterate over all key-value pairs in a database allowing the values to be modified<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>

    
  </dd>
</div>
<div id="mpairs.i,Transaction[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#mpairs.i%2CTransaction%5BA%2CB%5D"><span class="Identifier">mpairs</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Keyword">var</span> <span class="Identifier">B</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="limdb.html#Writes"><span class="Identifier">Writes</span></a><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Iterate over all key-value pairs in a database with a transaction, allowing the values to be modified.
    
  </dd>
</div>

</div>
<div id="mvalues-iterators-all">
  <div id="mvalues.i,Database[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#mvalues.i%2CDatabase%5BA%2CB%5D"><span class="Identifier">mvalues</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    Iterate over all values in a database allowing modification<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>

    
  </dd>
</div>
<div id="mvalues.i,Transaction[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#mvalues.i%2CTransaction%5BA%2CB%5D"><span class="Identifier">mvalues</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">B</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="limdb.html#Writes"><span class="Identifier">Writes</span></a><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    Iterate over all values in a database with a transaction, allowing the values to be modified.
    
  </dd>
</div>

</div>
<div id="pairs-iterators-all">
  <div id="pairs.i,Database[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#pairs.i%2CDatabase%5BA%2CB%5D"><span class="Identifier">pairs</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Iterate over all values in a database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>

    
  </dd>
</div>
<div id="pairs.i,Transaction[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#pairs.i%2CTransaction%5BA%2CB%5D"><span class="Identifier">pairs</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Iterate over all key-value pairs in a database with a transaction.
    
  </dd>
</div>

</div>
<div id="values-iterators-all">
  <div id="values.i,Database[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#values.i%2CDatabase%5BA%2CB%5D"><span class="Identifier">values</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    Iterate over all values in a database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>

    
  </dd>
</div>
<div id="values.i,Transaction[A,B]">
  <dt><pre><span class="Keyword">iterator</span> <a href="#values.i%2CTransaction%5BA%2CB%5D"><span class="Identifier">values</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">B</span></pre></dt>
  <dd>
    
    Iterate over all values in a database with a transaction.
    
  </dd>
</div>

</div>

  </dl>
</div>
<div class="section" id="18">
  <h1><a class="toc-backref" href="#18">Templates</a></h1>
  <dl class="item">
    <div id="clear-templates-all">
  <div id="clear.t,Transaction[A,B]">
  <dt><pre><span class="Keyword">template</span> <a href="#clear.t%2CTransaction%5BA%2CB%5D"><span class="Identifier">clear</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Remove all key-values pairs from the database, emptying it.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
The size of the database will stay the same on-disk but won't grow until more data than was in there before is added. It will shrink if it is copied.</div>

    
  </dd>
</div>

</div>
<div id="close-templates-all">
  <div id="close.t,Database[A,B]">
  <dt><pre><span class="Keyword">template</span> <a href="#close.t%2CDatabase%5BA%2CB%5D"><span class="Identifier">close</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Close the database directory. This will free up some memory and make all databases that were created from the same directory unavailable. This is not necessary for many use cases.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This creates and commits a transaction under the hood</div>

    
  </dd>
</div>

</div>
<div id="contains-templates-all">
  <div id="contains.t,Database[A,B],A">
  <dt><pre><span class="Keyword">template</span> <a href="#contains.t%2CDatabase%5BA%2CB%5D%2CA"><span class="Identifier">contains</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Alias for hasKey to support <tt class="docutils literal"><span class="pre"><span class="Keyword">in</span></span></tt> syntax in transactions
    
  </dd>
</div>

</div>
<div id="del-templates-all">
  <div id="del.t,Transaction[A,B],A">
  <dt><pre><span class="Keyword">template</span> <a href="#del.t%2CTransaction%5BA%2CB%5D%2CA"><span class="Identifier">del</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">A</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Delete a value in a transaction<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
LMDB requires you to delete by key and value. This proc fetches the value for you, giving you the more familiar interface.</div>

    
  </dd>
</div>

</div>
<div id="len-templates-all">
  <div id="len.t,Transaction[A,B]">
  <dt><pre><span class="Keyword">template</span> <a href="#len.t%2CTransaction%5BA%2CB%5D"><span class="Identifier">len</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">[</span><span class="Identifier">A</span><span class="Other">,</span> <span class="Identifier">B</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    Returns the number of key-value pairs in the database.
    
  </dd>
</div>

</div>
<div id="toBlob-templates-all">
  <div id="toBlob.t">
  <dt><pre><span class="Keyword">template</span> <a href="#toBlob.t"><span class="Identifier">toBlob</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">SomeNumber</span> <span class="Operator">|</span> <span class="Identifier">array</span> <span class="Operator">|</span> <span class="Keyword">tuple</span> <span class="Operator">|</span> <span class="Keyword">object</span><span class="Other">)</span><span class="Other">:</span> <a href="limdb.html#Blob"><span class="Identifier">Blob</span></a></pre></dt>
  <dd>
    
    Convert a string to a chunk of data, key or value, for LMDB<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
If you want other data types than a string, implement this for the data type</div>

    
  </dd>
</div>

</div>
<div id="with-templates-all">
  <div id="with.t,Database,untyped">
  <dt><pre><span class="Keyword">template</span> <a href="#with.t%2CDatabase%2Cuntyped"><span class="Identifier">with</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">untyped</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Execute a block of code in a transaction. Commit if there are any writes, otherwise reset.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
Available using Nim 1.4 and above</div>

    
  </dd>
</div>

</div>

  </dl>
</div>

  </div>
</div>

      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br>
        <small style="color: var(--hint);">Made with Nim. Generated: 2023-04-25 13:10:41 UTC</small>
      </div>
    </div>
  </div>
  
  <!-- Google fonts -->
  <link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>
</body>
</html>
